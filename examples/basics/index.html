<!DOCTYPE html>
<html>
  <head>
    <title>JS SDK Demos</title>
    <link rel="shortcut icon" href="">
    <link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/design.optimizely.com/oui/latest/styles.css">
    <style>
      body { padding: 30px; }
    </style>

    <script src="https://unpkg.com/@optimizely/optimizely-sdk/dist/optimizely.browser.umd.min.js"></script>

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.1/underscore-min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
  </head>
  <body>
    <div id="app">
      Loading...
    </div>

    <!-- Templates -->
    <script type="text/template" id="indexTemplate">
      <h1>Optimizely Javascript SDK Demos</h1>
      <ul>
        <% _.each(demos, function (demo) { %>
          <li>
            <a href="#/demo/<%= demo.name %>"><%= demo.name %></a>
          </li>
        <% }); %>
      </ul>
    </script>
    <script type="text/template" id="demoTemplate">
      <a href="/">back</a>
      <h1>Hello demo: <%= demoName %></h1>
      <script src="/<%= demoName %>.js"></script>
    </script>

    <script>
    $(document).ready(function() {
      const USERS = [

      ];
      const DEMOS = [
        {name: 'hello-world'},
        {name: 'audience-targeting'},
        {name: 'event-tracking'},
        {name: 'forced-variation'},
        {name: 'ab-test'},
      ];

      const Views = {
        Index: Backbone.View.extend({
          template: _.template($('#indexTemplate').html()),
          render: function() {
            this.$el.html(
              this.template({demos: DEMOS})
            );
            return this;
          }
        }),
        Demo: Backbone.View.extend({
          template: _.template($('#demoTemplate').html()),
          render: function(params) {
            this.$el.html(
              this.template(params)
            );
            return this;
          }
        })
      };

      const App = Backbone.Router.extend({
        routes: {
          "": "index",
          "demo/:demoName": "demo",
        },
        $container: $('#app'),
        initialize: function() {
          this.index();
          Backbone.history.start();
        },
        index: function () {
          var view = new Views.Index();
          this.$container.html(view.render().el);
        },
        demo: function (demoName) {
          var view = new Views.Demo();
          this.$container.html(view.render({demoName}).el);
        },
      });

      new App();
    });
    </script>
  </body>
</html>
